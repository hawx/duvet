#!/usr/bin/env ruby
#
# A command line tool for coverage testing, I'm not sure if this
# will even work but it is worth a try!
#
# Example:
#   duvet test/test_class.rb
#
$LOAD_PATH.unshift(File.join(File.dirname(__FILE__), '..', 'lib'))

require 'clive'
require 'duvet'

opts = {:dir => 'cov', :style => 'rcov'}
c = Clive.new do
  
  header "Usage: duvet [options] [paths]"
  
  flag(:css, "PATH", "Use custom css file") do |i| 
    opts[:css] = i
  end
  
  flag(:s, :style, "ARG", "Choose style") do |i|
    opts[:style] = i
  end
  
  flag(:d, :dir, "PATH", "Directory to write coverage results") do |i|
    opts[:dir] = i
  end
  
end

# Start coverage, then require paths
def run(paths, opts)
  Duvet.start(opts)
  paths.each do |p|
    require p
  end
end

args = c.parse(ARGV)
run(args, opts)
